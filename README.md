# Lyrics make Earth

## このアプリについて
マジカルミライ2025プログラミングコンテスト用に作成したものです。<br>
歌詞が１文字ずつパネルになり、地球のような球体を作成します。

## 特徴
- 発声されるタイミングで歌詞パネルがカメラ前に飛んできます。
- その後、歌詞パネルが前方に移動して球体を作ります。
- パネルカラーは発声された時点のコードを曲中で多い順にランク付けして決定しています。地球に似せるため、海の青や大陸の緑が多くなるように調整しています。
- ビートタイミングに応じて球体パネルが挙動します。
- 球体は歌詞の文字数によって大きさが決定され、球体完成後には周りに小さな球体として配置しています。
- サビのタイミングで背景を変更して、曲の盛り上がりを演出しています。
- 視点はマウス操作、キーボード操作、タッチ操作で移動や接近ができます。

![プレビュー動画です](preview/preview.gif)

## 開発
Node.js をインストールしている環境で以下のコマンドを実行すると、開発用サーバが起動します。
[three-js](https://threejs.org)、[vite](https://ja.vite.dev)を使用しています。パネルの角に丸みをつける目的で[three-stdlib]()も読み込んでいます。

``` bash
npm install
npm run dev
```
### 開発について
 パネル(cube)の挙動を3〜4段階に分類しました。<br>
- パネル(cube)の出現<br>
 歌詞の発声時にちょうどカメラの前にパネルが来るようにするため、アプリ内で設定したフレーム数(this._frameNum)前に出現させています。<br>
- 1次アニメーション<br>
 座標(0,0,0)からカメラの位置までの移動を行います。その際、パネルが真正面に来るターゲット座標を出現時のカメラの速度に応じて予測しています。<br>
- 2次アニメーション<br>
 ランダムに球体に張り付くようにターゲット座標を決定しています。<br>
- 3次アニメーション<br>
 球体に張り付いたパネルをビートに合わせて動かしています。また、球体完成後は球体の周りにパネルを球体に変化させて配置するようにしました。<br>
 
## ビルド

以下のコマンドで dist 以下にビルド済みファイルが生成されます。
``` bash
npm run build
```

## 動作テスト
以下の環境で動作テストを行なっています。
- M1 MacStudio , macOS 15.5
- M2 iPadair 13 , iPadOS 18.5 
